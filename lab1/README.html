<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Munging for data visualization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="README_files/libs/clipboard/clipboard.min.js"></script>
<script src="README_files/libs/quarto-html/quarto.js"></script>
<script src="README_files/libs/quarto-html/popper.min.js"></script>
<script src="README_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="README_files/libs/quarto-html/anchor.min.js"></script>
<link href="README_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="README_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="README_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="README_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="README_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="README_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="README_files/libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#instructions" id="toc-instructions" class="nav-link active" data-scroll-target="#instructions">Instructions</a></li>
  <li><a href="#demonstration" id="toc-demonstration" class="nav-link" data-scroll-target="#demonstration">Demonstration</a>
  <ul class="collapse">
  <li><a href="#can-we-do-this-using-non-tidy-data" id="toc-can-we-do-this-using-non-tidy-data" class="nav-link" data-scroll-target="#can-we-do-this-using-non-tidy-data">Can we do this using non-tidy data?</a></li>
  <li><a href="#using-tidy-data" id="toc-using-tidy-data" class="nav-link" data-scroll-target="#using-tidy-data">Using tidy data</a></li>
  </ul></li>
  <li><a href="#tidy-data" id="toc-tidy-data" class="nav-link" data-scroll-target="#tidy-data">Tidy data</a>
  <ul class="collapse">
  <li><a href="#typical-problems-to-be-fixed" id="toc-typical-problems-to-be-fixed" class="nav-link" data-scroll-target="#typical-problems-to-be-fixed">Typical problems to be fixed</a></li>
  <li><a href="#tools-for-tidying-data" id="toc-tools-for-tidying-data" class="nav-link" data-scroll-target="#tools-for-tidying-data">Tools for tidying data</a></li>
  </ul></li>
  <li><a href="#the-assignment" id="toc-the-assignment" class="nav-link" data-scroll-target="#the-assignment">The Assignment</a>
  <ul class="collapse">
  <li><a href="#tasks" id="toc-tasks" class="nav-link" data-scroll-target="#tasks">Tasks</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="README.md"><i class="bi bi-file-code"></i>Github (GFM)</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Munging for data visualization</h1>
<p class="subtitle lead">A DSAN 5200 Laboratory</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="instructions" class="level1">
<h1>Instructions</h1>
<p>This laboratory explores data munging for data visualization and the utility of tidy data in data visualization toolkits. It will consist of a demonstration done in class, and an assignment that must be submitted for grade and completion. All submissions will be via GitHub Classroom.</p>
<ol type="1">
<li>The assignment portion must be done in a fresh Quarto notebook named in the format “l1-[last name]-[first name]-wrangling.qmd”. You may use either R or Python to complete the assignment in this notebook.</li>
</ol>
<ul>
<li>If using R, you must use the <code>ggplot2</code> package for visualization, and the <code>tidyverse</code> packages for data munging.</li>
<li>If using Python, you must use the <code>matplotlib</code> and/or <code>seaborn</code> packages for visualization, and <code>pandas</code> for data munging.</li>
</ul>
<ol start="2" type="1">
<li>The final submission will be denoted by a git commit with the commit message <code>final submission</code>. This will be what is evaluated for grade. This must include:</li>
</ol>
<ul>
<li>The file <code>l1-[lastname]-[firstname]-wrangling.qmd</code> with <code>lastname</code> and <code>firstname</code> replaced with your last and first name, respectively.</li>
<li><code>l1-image.png</code>, created in your Quarto notebook</li>
<li><code>cleaned_data.csv</code>, which contains the final munged data that is used for generating <code>l1-image.png</code>. This must be in tidy format.</li>
</ul>
<hr>
</section>
<section id="demonstration" class="level1">
<h1>Demonstration</h1>
<p>The dataset we will be demostrating today is an extract from a gene expression dataset generated in a series of yeast experiments <a href="http://www.molbiolcell.org/content/19/1/352.abstract" target="_blank">Brauer, 2008</a>, where yeast were starved of certain nutrients to see how their gene expression changed. Basically, if you give yeast plenty of nutrients (a rich media), except that you sharply restrict its supply of one nutrient, you can control the growth rate to whatever level you desire (we do this with a tool called a chemostat). For example, you could limit the yeast’s supply of glucose (sugar, which the cell metabolizes to get energy and carbon), of leucine (an essential amino acid), or of ammonium (a source of nitrogen).</p>
<p>“Starving” the yeast of these nutrients lets us find genes that:</p>
<ul>
<li><strong>Raise or lower their activity in response to growth rate</strong>. Growth-rate dependent expression patterns can tell us a lot about cell cycle control, and how the cell responds to stress.</li>
<li><strong>Respond differently when different nutrients are being limited</strong>. These genes may be involved in the transport or metabolism of those nutrients.</li>
</ul>
<p>This data looks at six nutrients, denoted G, L, N, P, S, and U (think of these as categories). Under each column is the gene expression for a particular gene, as the rate at which the yeast was starved changes (<code>rate</code>).</p>
<div class="cell">
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">GID</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">G</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">N</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">P</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">S</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">L</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">U</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">-0.31</td>
<td style="text-align: right;">-0.21</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">-0.31</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">-0.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">-0.13</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">-0.29</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">-0.31</td>
<td style="text-align: right;">-0.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">-0.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">-0.43</td>
<td style="text-align: right;">-0.24</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">-0.43</td>
<td style="text-align: right;">-0.35</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>What we’d like to see is, for this gene, how the gene expression changes with the rate. We’d like to see something like this:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="README_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>To do this, we need to get the data into a tidy format.</p>
<p>Tidy data is defined by</p>
<ul>
<li>Each variable forms a column.</li>
<li>Each observation forms a row.</li>
<li>Each type of observational unit forms a table.</li>
</ul>
<p>For any of the toolkits we’ll be using for this lab (ggplot2/matplotlib/seaborn), we need to get the data into a tidy format. How do I know this?</p>
<ul>
<li>All of them demand that particular columns be used for particular things. For example, in ggplot2, the <code>x</code> and <code>y</code> aesthetics are used for the x and y coordinates of the plot.</li>
<li>This means that values in a column determine those visual attributes (we’ll call these visual encodings later).</li>
</ul>
<section id="can-we-do-this-using-non-tidy-data" class="level2">
<h2 class="anchored" data-anchor-id="can-we-do-this-using-non-tidy-data">Can we do this using non-tidy data?</h2>
<p>Sure, we can, but it’s much more painful and doesn’t use the capabilities or syntactical sugar that is built into the toolkits.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cleaned_data, <span class="fu">aes</span>(<span class="at">x =</span> rate)) <span class="sc">+</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> G, <span class="at">color =</span> <span class="st">"G"</span>)) <span class="sc">+</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> L, <span class="at">color =</span> <span class="st">"L"</span>)) <span class="sc">+</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> N, <span class="at">color =</span> <span class="st">"N"</span>)) <span class="sc">+</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> P, <span class="at">color =</span> <span class="st">"P"</span>)) <span class="sc">+</span> </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> S, <span class="at">color =</span> <span class="st">"S"</span>)) <span class="sc">+</span> </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> U, <span class="at">color =</span> <span class="st">"U"</span>)) <span class="sc">+</span> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="README_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="using-tidy-data" class="level2">
<h2 class="anchored" data-anchor-id="using-tidy-data">Using tidy data</h2>
<p>However, if we munge the data into a tidy format, we can do this much more easily.</p>
<p>What do we need to do to make this data tidy?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>cleaned_data_munged <span class="ot">&lt;-</span> cleaned_data <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(rate, GID), </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"nutrient"</span>, <span class="at">values_to =</span> <span class="st">"expression"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">GID</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rate</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">nutrient</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">expression</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">-0.31</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">-0.21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: left;">P</td>
<td style="text-align: right;">0.41</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: left;">S</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: left;">L</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: left;">U</td>
<td style="text-align: right;">0.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">-0.27</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">-0.31</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: left;">P</td>
<td style="text-align: right;">0.61</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: left;">S</td>
<td style="text-align: right;">-0.04</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: left;">L</td>
<td style="text-align: right;">-0.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: left;">U</td>
<td style="text-align: right;">-0.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">-0.19</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">0.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: left;">P</td>
<td style="text-align: right;">0.88</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: left;">S</td>
<td style="text-align: right;">0.19</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: left;">L</td>
<td style="text-align: right;">0.18</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: left;">U</td>
<td style="text-align: right;">-0.13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">-0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">-0.29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: left;">P</td>
<td style="text-align: right;">0.56</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: left;">S</td>
<td style="text-align: right;">-0.03</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: left;">L</td>
<td style="text-align: right;">-0.31</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: left;">U</td>
<td style="text-align: right;">-0.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">-0.22</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: left;">P</td>
<td style="text-align: right;">0.72</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: left;">S</td>
<td style="text-align: right;">0.03</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: left;">L</td>
<td style="text-align: right;">-0.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: left;">U</td>
<td style="text-align: right;">-0.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">-0.43</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">-0.24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: left;">P</td>
<td style="text-align: right;">0.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: left;">S</td>
<td style="text-align: right;">-0.27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: left;">L</td>
<td style="text-align: right;">-0.43</td>
</tr>
<tr class="even">
<td style="text-align: left;">GENE2922X</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: left;">U</td>
<td style="text-align: right;">-0.35</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cleaned_data_munged, <span class="fu">aes</span>(rate, expression, <span class="at">color =</span> nutrient)) <span class="sc">+</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="README_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="tidy-data" class="level1">
<h1>Tidy data</h1>
<section id="typical-problems-to-be-fixed" class="level2">
<h2 class="anchored" data-anchor-id="typical-problems-to-be-fixed">Typical problems to be fixed</h2>
<ul>
<li>Column headers are values, not variable names.</li>
<li>Multiple variables are stored in one column.</li>
<li>Variables are stored in both rows and columns.</li>
<li>Multiple types of observational units are stored in the same table.</li>
<li>A single observational unit is stored in multiple tables.</li>
</ul>
<p>Tidy data is a conceptual framework to structure data in a consistent, analyses-friendly manner. It helps identify ways in which data are not tidy.</p>
<p>The crucial question for a particular study is: what is a variable and what is an observational unit. For example, your data consists of hospitalizations across a healthcare network.</p>
<ul>
<li>If you’re interested in comparing hospitals, the hospital is the observational unit.</li>
<li>If you’re interested in readmissions, then the patient is the unit of observation.</li>
<li>If you’re interested in treatment and care, then the hospital visit is the unit of observation</li>
</ul>
</section>
<section id="tools-for-tidying-data" class="level2">
<h2 class="anchored" data-anchor-id="tools-for-tidying-data">Tools for tidying data</h2>
<p>The main tools you need for tidying data are:</p>
<ul>
<li>pivoting (<code>pivot_longer</code> and <code>pivot_wider</code>, or <code>melt</code> and <code>pivot</code> in <code>pandas</code>)</li>
<li>separating a single column into multiple columns (<code>separate</code> in <code>tidyr</code>, or <code>str.split</code> in <code>pandas</code>)</li>
<li>combining multiple columns into a single column (<code>unite</code> in <code>tidyr</code>, or <code>str.join</code> in <code>pandas</code>)</li>
<li>split-apply-combine (<code>group_by</code> and <code>summarize</code> in <code>dplyr</code>, or <code>groupby</code> and <code>agg</code> in <code>pandas</code>)</li>
</ul>
<p>You really need to know these tools <strong>really well</strong> in order to do data science proficiently.</p>
<hr>
</section>
</section>
<section id="the-assignment" class="level1">
<h1>The Assignment</h1>
<p>There is a file in the <code>data</code> directory called <code>raw.csv</code>. This is the full dataset from which the demonstration is derived, and comprises the same sort of data for multiple genes. It includes metadata about the genes, stored in the <code>NAME</code> column. Data in this column is of the format</p>
<pre><code>&lt;gene name &gt; || &lt;biological process&gt; || &lt;molecular function&gt; || &lt;systematic
name&gt;</code></pre>
<section id="tasks" class="level2">
<h2 class="anchored" data-anchor-id="tasks">Tasks</h2>
<ol type="1">
<li>Munge the data into a tidy format and save it as <code>cleaned_data.csv</code>. This will involve:</li>
</ol>
<ul>
<li>Separating the <code>NAME</code> column into multiple columns (named <code>gene_name</code>, <code>biological_process</code>, <code>molecular_function</code>, and <code>systematic_name</code>).</li>
<li>Pivoting the data so that the column names <code>G</code>, <code>L</code>, <code>N</code>, <code>P</code>, <code>S</code>, and <code>U</code> are in a single column, and the values are in another column (<code>expression</code>).</li>
</ul>
<ol start="2" type="1">
<li>Create the following visualization and save it as <code>l1-image.png</code>.</li>
</ol>
<ul>
<li>If you’re doing this in Python, I strongly suggest using <code>seaborn</code> for this. You may get slightly different names for the panels, but that will be alright</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="README_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
</div> <!-- /content -->



</body></html>